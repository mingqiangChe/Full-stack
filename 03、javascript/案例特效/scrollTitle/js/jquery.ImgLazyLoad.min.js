$(function(b,c){function a(d){this.options={width:380,heiht:240,callback:function(){},imgCallback:function(){},scrollTrigger:true,};this.options=c.extend(this.options,d);this.container=this.options.container;this.init()}a.prototype.init=function(){this.initOptions();this.calcContain();if(this.options.scrollTrigger){this.onScroll()}else{this.bindClick()}typeof this.options.callback==="function"&&this.options.callback.call(this)&&this.options.callback()};a.prototype.initOptions=function(){c(this.container).find("img.loading").parent().css({width:this.options.width,height:this.options.height});c(this.container).find("img").css({width:"100%",height:"100%",display:"block",backgroundColor:"#C0C0C0",})};a.prototype.calcContain=function(e){var d=this;var e=e||c(d.container).find("img.loading");e.each(function(h,k){var g=c(d.container)[0].getBoundingClientRect();var f=g.width+g.left;var i=g.height+g.top;var j=k.getBoundingClientRect();var m=j.top;var l=j.left;if(f>l&&i>m){c(k).attr("src",c(k).data("src"));c(k).on("load",function(){c(k).removeClass("loading");typeof d.options.imgCallback==="function"&&d.options.imgCallback.call(this)&&d.options.imgCallback()})}})};a.prototype.onScroll=function(){var e=this;var d;c(this.container).scroll(function(){if(!d){d=setTimeout(function(){e.calcContain();clearTimeout(d);d=null})}})};a.prototype.bindClick=function(){var d=this;c(this.container).find("img.loading").on("click",function(){d.calcContain(c(this))})};c.fn.extend({imgLazyLoad:function(d){d["container"]=d.container||this;return new a(d)}})}(window,jQuery));