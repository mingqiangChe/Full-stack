# 微信小程序——餐饮点餐商城

微信小程序——餐饮点餐商城，是针对餐饮行业推出的一套完整的餐饮解决方案，实现了用户在线点餐下单、外卖、叫号排队、支付、配送等功能，完美的使餐饮行业更高效便捷！

大家如果在使用过程有什么问题，欢迎通过lssues与我们交流！

如果本项目对您有所帮助或者启发，请给我们 Star 吧，您的鼓励是我们最大对动力～

# 招募开发者

希望找一些志同道合的朋友一起来完善这个开源项目，持续更新下去，有兴趣的可以联系管理员，期待您的加入！

QQ群：926321567

# 荣誉墙

- [@woniudiancang 蜗牛小姐姐，本项目主导者、发起人](https://github.com/woniudiancang)
- [@wangxy2020 Jack Wong](https://github.com/wangxy2020)
- 期待您的加入

# 功能展示
## 首页
| 首页  | 下单 | 加入购物车 | 查看门店信息 |
| :------: | :------: | :------: |  :------: | 
| <img src="https://dcdn.it120.cc/2020/09/02/234d8e67-2f98-4f0e-af5f-e6b73dda6317.png" width="200px">|<img src="https://dcdn.it120.cc/2020/08/02/adc268d2-51ed-4bac-93d7-303060c17396.png" width="200px">| <img src="https://dcdn.it120.cc/2020/08/02/a208698c-d278-4a21-817f-30ae083a878e.png" width="200px">| <img src="https://dcdn.it120.cc/2020/09/02/dadf5367-25ca-4a17-9c51-269ee2c87763.png" width="200px">

### 营销功能
| 拼团 | 签到  | 
| :------: | :------: |
| <img src="https://dcdn.it120.cc/2020/09/02/a3f3ec3e-0525-43da-9911-5c972e0f8157.jpg" width="200px">| <img src="https://dcdn.it120.cc/2020/09/02/fbd597e5-3d6f-45ee-a7a9-804421dc8fcd.png" width="200px">

## 优惠券
| 优惠券  | 待领取 | 可使用 | 
| :------: | :------: | :------: |
| <img src="https://dcdn.it120.cc/2020/08/10/8e35654b-d769-41e4-88cd-2079058018e3.png" width="200px">|<img src="https://dcdn.it120.cc/2020/08/10/330cf025-249f-45c0-a299-adb296c6c4ad.png" width="200px">| <img src="https://dcdn.it120.cc/2020/08/10/5fc934d1-bf17-428d-9af0-d6adf9ee24d3.png" width="200px">

## 结算 支付
| 自取 | 配送 | 优惠买单 | 买单 |
| :------: | :------: | :------: |:------: |
|<img src="https://dcdn.it120.cc/2020/08/02/95bf93e9-bad2-4929-8d3d-f946602907ab.png" width="200px">|<img src="https://dcdn.it120.cc/2020/08/02/9d5c16a3-5eb0-4546-8214-8ceae986f34f.png" width="200px">|<img src="	https://dcdn.it120.cc/2020/08/02/58a6b990-1436-43aa-9be2-4ae0487421a1.png" width="200px">|<img src="https://dcdn.it120.cc/2020/08/02/1da65ea2-452e-43e7-9eaf-5729539ab13b.png" width="200px">


## 订单管理
| 待支付 |全部订单 | 配送 | 取餐 | 交易完成 |
| :------: | :------: | :------: |:------: |:------: |
|<img src="	https://dcdn.it120.cc/2020/08/02/140a9490-3332-4725-b26a-4e064898cf37.png" width="200px">|<img src="https://dcdn.it120.cc/2020/08/02/2fd17aa4-d8e9-4b0a-b777-99d7001c3b5a.png" width="200px">|<img src="	https://dcdn.it120.cc/2020/08/02/88fe8565-2f75-40b7-b279-a431236d8cc7.png" width="200px">|<img src="https://dcdn.it120.cc/2020/08/02/4e8b22bf-71fc-4bd6-bf70-9a0d90916d40.png" width="200px">|<img src="https://dcdn.it120.cc/2020/08/02/3bf2bae6-8b1e-4e66-9a7b-d958bfd2860f.png" width="200px">


## 我的
| 我的 | 会员中心 | 收货地址 |关于我们 
| :------: | :------: | :------: | :------: | 
| <img src="https://dcdn.it120.cc/2020/08/13/efb272e8-6c36-4997-87ef-eb643f0a36fa.png" width="200px">| <img src="https://dcdn.it120.cc/2020/08/02/3a29305c-0b2b-4f8f-99e7-296e6731ef0f.png" width="200px">|<img src="https://dcdn.it120.cc/2020/08/02/9f31d35d-c812-419e-b904-6e05a281f90c.png" width="200px">|<img src="https://dcdn.it120.cc/2020/08/02/5c040f55-47fa-4dcf-88f7-be7d883d1222.png" width="200px">

| 我的钱包 |资金明细 | 积分明细 |充值记录
| :------: | :------: | :------: | :------: |
|<img src="https://dcdn.it120.cc/2020/08/13/e063c311-7493-46b0-b258-fae298b452a3.png" width="200px">|<img src="https://dcdn.it120.cc/2020/08/13/ab2f640d-9b0e-41d4-b41e-0605f4df0d7e.png" width="200px">|<img src="https://dcdn.it120.cc/2020/08/13/70f9c64e-0c8d-4f35-b50d-0af7f48e2e23.png" width="200px">|<img src="https://dcdn.it120.cc/2020/08/13/39e981cf-cf7e-42f8-9513-9f496f008a03.png" width="200px">

## 其他
| 在线订位 | 在线取号 |
| :------: | :------: |
| <img src="https://dcdn.it120.cc/2020/08/10/0f7e8d16-d05d-40dd-82e0-b4faedf01520.png" width="200px"> | <img src="https://dcdn.it120.cc/2020/10/05/542ac4b7-e49b-4225-8ee0-b99474082924.png" width="190px">

## 扫码点餐
| 扫桌码点餐 | 共享购物车 | 查看已点 | 买单结账 |
| :------: | :------: | :------: | :------: |
| <img src="https://dcdn.it120.cc/2020/10/08/f7d15bc6-c366-4688-92f4-62183d87c898.png" width="200px"> | <img src="https://dcdn.it120.cc/2020/10/08/31c7fd0c-4cbe-4702-b318-02eccbc1d41f.png" width="190px"> | <img src="https://dcdn.it120.cc/2020/10/08/2ebad9a2-39d1-4c3b-8f9d-a64628e1dd86.png" width="190px"> | <img src="https://dcdn.it120.cc/2020/10/08/f935fb79-7565-41ee-a2b4-5c9a50348479.png" width="190px">

| 待确认 | 已下厨 | 已上菜 |
| :------: | :------: | :------: |
| <img src="https://dcdn.it120.cc/2020/10/09/21a75f2c-75c2-495b-bdbf-505e75b516ce.png" width="200px"> | <img src="https://dcdn.it120.cc/2020/10/09/b1277a38-044b-433d-92b3-8ecf8f433769.png" width="190px"> | <img src="https://dcdn.it120.cc/2020/10/09/3fb83702-8093-4530-ac28-95ba912a7cff.png" width="190px">

# QQ交流群

    群号:926321567

<img src="https://dcdn.it120.cc/2020/07/27/e3d09fd2-ace0-4cf4-9d71-e0454591ff54.png " width="200px">

# 本项目使用了下面的组件，在此鸣谢

- [vant-UI库](https://youzan.github.io/vant-weapp/)

- [小程序在线接口-SDK](https://github.com/gooking/apifm-wxapi)

- [api工厂](https://admin.it120.cc)

- [FMUI-轻松活泼-icon](https://www.iconfont.cn/collections/detail?spm=a313x.7781069.0.da5a778a4&cid=17041)

- [小程序HTML解析组件](https://github.com/jin-yufeng/Parser)

- [生成条码和二维码](https://github.com/alsey/wxbarcode)

# 使用教程

## 注册开通小程序账号

https://mp.weixin.qq.com/
根据自己的实际情况选择 “企业”、“个体工商户”身份，注册小程序账号，商城类小程序不支持个人用户上线，所以一定要选择企业或者个体户，获得你自己小程序的 appid 和 secret 信息，保存好，下面会用到：
- [如何查看小程序的AppID和AppSecret](https://jingyan.baidu.com/article/642c9d340305e3644a46f795.html)

    你需要设置小程序的合法域名，否则开发工具上运行正常，手机访问的时候将看不到数据
- [设置合法服务器域名](https://www.it120.cc/help/tvpou9.html)

## 注册开通后台账号

https://admin.it120.cc/
免费注册开通新后台后登录，登录后的首页，请记下你的专属域名，后面会用到
左侧菜单 “工厂设置” --> “数据克隆” --> “将别人的数据克隆给我”
对方商户ID填写 27
点击 “立即克隆”，克隆成功后，F5 刷新一下后台

## 配置小程序APPID/SECRET

左侧菜单，微信设置，填写配置上一步获得的 appid 和 secret
这一步很重要！！！
如果没有正确配置，下面步骤中打开小程序将无法连接你的后台

## 配置微信支付

左侧菜单，系统设置 -->  在线支付配置，填写您自己的微信支付的信息

## 下载安装开发工具

https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html

## 运行小程序看效果

### 双击运行第一步安装的小程序开发工具，打开看效果：

<img src="https://dcdn.it120.cc/yuque/0/2019/png/572726/1575349127431-00ff2059-dd5e-4e4b-99a7-e1d605db02c7.png?x-oss-process=image%2Fresize%2Cw_1500 " width="200px">

### 导入项目这里

目录选择你 “第二步” 中下载并加压的小程序代码所在目录

**APPID 务必要改成你自己的小程序的 APPID**

**APPID 务必要改成你自己的小程序的 APPID**

**APPID 务必要改成你自己的小程序的 APPID**

### 然后点击导入按钮

- [如何查看小程序的AppID和AppSecret](https://jingyan.baidu.com/article/642c9d340305e3644a46f795.html)

## 配置对接你自己的后台
在开发工具中 config.js 中的subDomain 改成你自己专属域名， ctrl + s 保存

<img src="https://dcdn.it120.cc/yuque/0/2020/png/572726/1581236703094-ce5c7f32-c60d-4e1b-bacb-21439e1d2721.png?x-oss-process=image%2Fresize%2Cw_1500 " width="200px">

- [如何查看自己的subDomain](https://www.it120.cc/help/qr6l4m.html)

## 如何修改小程序标题

要修改小程序标题 “蜜蜂点餐” ，请登陆后台，左侧菜单 “系统设置” --> “系统参数”，修改编号为 mallName 的那个参数即可；

## 口味/加料/配菜 设置

[《餐饮口味/加料/配菜/口味选项解决方案》](https://www.it120.cc/help/eoee8a.html)


## 小票打印机

<img src="https://dcdn.it120.cc/2020/10/05/5fc1dd74-130d-421c-83de-ab5555d914bd.png" width="200px">

[《api工厂小票机 / 不干胶标签机配置自动打印》](https://www.it120.cc/help/ggrun8.html)

小票机是打印热敏小票，例如超市购物时候打印的小票；美团、饿了么外卖的打印小票；

标签机是打印的不干胶的，例如奶茶店打印出来贴在杯子上面的；

## 扫码点餐

### 生成桌码

1. 首先需要在后台“餐桌管理”中，将你的餐桌信息维护好，例如: A1 A2 B1 B2
2. 给每个餐桌生成小程序码，前往后台 “微信设置” --> “小程序设置” --> “获取小程序码”
3. 页面路径填写: pages/index/index
4. scene参数填写: shopId=36,id=111,key=Y6RoIT （36改成你自己门店的id；111改成对应的餐桌的id；Y6RoIT 改成对应的餐桌的密钥，为了防止用户恶意扫码，建议定期更换密钥后重新生成桌码）

**注意：微信小程序只有正式上线的小程序才可以获取小程序码，所以如果是开发阶段，可以按照下面的说明在开发工具中测试**

### 如何测试扫码点餐

修改 “pages/index/index.js” 文件的 onLoad 方法，放开下面的注释即可：

```js
// 测试扫码点餐
// shopId=36,id=111,key=Y6RoIT 进行 url编码，3个值分别为 门店id，餐桌id，餐桌密钥
// e = {
//   scene: 'shopId%3d36%2cid%3d111%2ckey%3dY6RoIT' 
// }
```

修改 js 文件后，请点击开发工具上的 “编译” 按钮，重新编译一下小程序，即可进行扫码点餐的测试

# 常见问题

## 无法登陆 / 无法获取 openid

1. 请检查 config.js 文件中的 subDomain 是否已经修改成你自己的专属域名了
    
    [如何查看自己的subDomain](https://www.it120.cc/help/qr6l4m.html)

2. 确保下面3个地方的 appID 你填的是一样的

    - 登录你的小程序商户后台（https://mp.weixin.qq.com）左侧菜单 “开发” --> “开发设置” 中的 appid
    - 点击你的小程序开发工具 右上角 的“详情” --> “基本信息” 中的 appid
    - 登录你的 api工厂 后台（https://admin.it120.cc），左侧菜单微信设置中的 appid

3. 在线订座提示“暂无数据”

    - 首先登陆后台，左侧菜单 “预约报名” --> “项目设置”，添加一个预约项目；（如果没有菜单，请去模块管理添加模块）
    - 添加成功后，记下项目编号（列表第一列中的数字）；
    - 左侧菜单 “系统设置” --> “系统参数”，修改编号为 “zxdz” 的参数，填写你自己的项目编号；
    - 小程序开发工具中，点击 “编译”按钮，重新编译小程序即可；



